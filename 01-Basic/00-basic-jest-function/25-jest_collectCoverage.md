
# การใช้งานคำสั่ง `jest --collectCoverage`

คำสั่ง `jest --collectCoverage` ใช้เพื่อเปิดใช้งานการเก็บข้อมูลความครอบคลุมของโค้ด (coverage) ระหว่างการทดสอบ โดยจะสร้างรายงานเกี่ยวกับว่าโค้ดส่วนไหนถูกทดสอบแล้ว และส่วนไหนยังไม่ได้ถูกทดสอบ การใช้คำสั่งนี้มีรายละเอียดดังนี้:

## การใช้งาน
คำสั่งนี้สามารถรันได้จาก command line โดยใช้:

```
jest --collectCoverage
```

หรือหากคุณต้องการเก็บข้อมูลความครอบคลุมสำหรับไฟล์เฉพาะหรือโฟลเดอร์ใด ๆ ก็สามารถรันได้โดยระบุ path ของไฟล์หรือโฟลเดอร์:

```
jest --collectCoverage path/to/your/test/file.js
```

## ผลลัพธ์จากคำสั่ง `--collectCoverage`
เมื่อรันคำสั่งนี้ จะได้ผลลัพธ์เป็นรายงานการครอบคลุมโค้ด ซึ่งจะบอกเราว่าโค้ดของเราถูกทดสอบมากน้อยแค่ไหน โดยแสดงข้อมูลต่อไปนี้:

1. **Statements**: จำนวน statement ทั้งหมดในโค้ดและจำนวน statement ที่ถูกทดสอบแล้ว
2. **Branches**: จำนวน branch หรือเงื่อนไขในโค้ด เช่น คำสั่ง `if` หรือ `switch` และจำนวน branch ที่ถูกทดสอบ
3. **Functions**: จำนวนฟังก์ชันทั้งหมดและจำนวนฟังก์ชันที่ถูกทดสอบ
4. **Lines**: จำนวนบรรทัดของโค้ดทั้งหมดและจำนวนบรรทัดที่ถูกทดสอบแล้ว

## โครงสร้างของรายงาน
หลังจากรันคำสั่ง รายงานจะถูกสร้างในโฟลเดอร์ `coverage` โดยอัตโนมัติ และมีรายงานในรูปแบบต่างๆ เช่น:

- **HTML**: สามารถเปิดดูในเบราว์เซอร์ได้โดยเปิดไฟล์ `index.html` ภายในโฟลเดอร์ `coverage/lcov-report/`
- **Text Summary**: จะแสดงใน command line โดยสรุปข้อมูลเกี่ยวกับความครอบคลุมของโค้ดในรูปแบบตาราง

ตัวอย่างผลลัพธ์ใน command line:

```
=============================== Coverage summary ===============================
Statements   : 85.71% (12/14)
Branches     : 75% (6/8)
Functions    : 100% (5/5)
Lines        : 85.71% (12/14)
================================================================================
```

จากตารางนี้:
- **Statements** มี 85.71% ที่ถูกทดสอบ (ทดสอบแล้ว 12 จากทั้งหมด 14 statements)
- **Branches** มี 75% ที่ถูกทดสอบ (ทดสอบแล้ว 6 จากทั้งหมด 8 branches)
- **Functions** ถูกทดสอบครบ 100% (ทั้งหมด 5 ฟังก์ชัน)
- **Lines** มี 85.71% ที่ถูกทดสอบ (12 จากทั้งหมด 14 บรรทัด)

## ประโยชน์ของการใช้ `--collectCoverage`
- **เพิ่มความมั่นใจ**: ช่วยให้เราทราบว่าฟังก์ชันและเงื่อนไขต่างๆ ในโค้ดถูกทดสอบแล้ว ทำให้โค้ดของเรามีความเสถียรมากขึ้น
- **ลดโอกาสเกิดบั๊ก**: ช่วยให้เรารู้ว่ามีส่วนไหนของโค้ดที่ยังไม่ได้ถูกทดสอบ ทำให้สามารถเพิ่มการทดสอบเพิ่มเติมเพื่อครอบคลุมโค้ดที่อาจมีบั๊กได้
- **ตรวจสอบความสมบูรณ์**: เหมาะสำหรับใช้ในโครงการที่ต้องการมาตรฐานในการครอบคลุมโค้ด เช่น ตั้งค่าให้โค้ดต้องมีการทดสอบครอบคลุมเกิน 90% ก่อนจะนำไปใช้งานจริง

## การตั้งค่าในไฟล์ `jest.config.js`
คุณสามารถตั้งค่า `collectCoverage` ไว้ในไฟล์ `jest.config.js` เพื่อให้เปิดใช้งานอัตโนมัติเมื่อรันคำสั่ง `jest` โดยไม่ต้องระบุทุกครั้ง เช่น:

```javascript
module.exports = {
  collectCoverage: true,
};
```

หากต้องการให้รายงานครอบคลุมเฉพาะไฟล์บางไฟล์ สามารถใช้ option อย่าง `collectCoverageFrom` เช่น:

```javascript
module.exports = {
  collectCoverage: true,
  collectCoverageFrom: ['src/**/*.js'],
};
```

วิธีนี้จะทำให้เก็บข้อมูลเฉพาะไฟล์ในโฟลเดอร์ `src` ที่มีนามสกุล `.js` เท่านั้น
